#Magicodes.Admin.Core框架上手教程
## 数据模型设计与数据库迁移
###创建Student实体
1. 在领域层创建Student文件夹，并创建Student实体类； 
2. Student实体类继承自于EntityBase，而EntityBase继承自于Entity同时还实现了IFullAudited和IMayHaveTenant接口（Magicodes.Admin.Core框架是基于ABP和ASP.NET Zero的基础上进行了封装和完善,ABP中所有的实体类都继承自Entity，而Entity实现了IEntity接口；而IEntity接口是一个泛型接口，通过泛型指定主键Id类型，默认的Entity的主键类型是int类型。通过实现审计接口IFullAudited指定创建者，创建时间，修改者，修改时间及删除者，删除时间，是否删除[软删除]基本信息，通过实现IMayHaveTenant来指定租户信息） 代码如下：
```
 namespace Magicodes.Admin.Tutorial.Student
{
    public class StudentInfo:Entity<long>
    {
        /// <summary>
        /// 姓名
        /// </summary>
        [Display(Name = "姓名")]
        [Required]
        [MaxLength(50)]
        public string Name { get; set; }
        /// <summary>
        /// 出生日期
        /// </summary>
        [Display(Name = "出生日期")]
        [Required]
        public DateTime BirthDate { get; set; }
        /// <summary>
        /// 性别
        /// </summary>
        [Display(Name="性别")]
        [Required]
        public Genders Genders { get; set; }
    }

    public enum Genders
    {
        /// <summary>
        /// 男
        /// </summary>
        Male=0,
        /// <summary>
        /// 女
        /// </summary>
        Female=10
    }
}
```
其中定义了Genders状态枚举。其中[Required]、[MaxLength]特性是用来进行输入校验的。

3. 定义好实体之后，我们就要去DbContext中定义实体对应的DbSet，以应用Code First 数据迁移。找到我们的基础服务层，即以EntityFramework结尾的项目中，找到DbContext类，添加以下代码
` public virtual DbSet<StudentInfo> StudentInfos { get; set; }`

4. 执行Code First 数据迁移
*  打开程序包管理器控制台，默认项目选择Entityframework对应的项目后。执行Add-Migration Add_Student_Entity，创建迁移。
*  创建成功后，会在Migrations文件夹下创建时间_Add_Student_Entity格式的类文件。如果注意观察，我们会发现Migrations文件夹下有个SeedData文件夹，顾名思义，这个文件夹下的类主要是用来进行预置种子数据的。我们可以参照已有类的写法，来预置两条Student。创建DefaultTestDataForStudent类，代码如下：
```
namespace Magicodes.Admin.Migrations.Seed.Tenants
{
    public class DefaultTestDataForStudent
    {
        private readonly AdminDbContext _context;

        private static readonly List<StudentInfo> _students;

        public DefaultTestDataForStudent(AdminDbContext context)
        {
            _context = context;
        }

        static DefaultTestDataForStudent()
        {
            _students = new List<StudentInfo>()
            {
                new StudentInfo(){
                    Name="张三",
                    BirthDate=DateTime.Now,
                    Genders=Genders.Male,
                    CreationTime = Clock.Now,
                },
            };
        }

        public void Create()
        {
            foreach (var student in _students)
            {
                if (_context.StudentInfos.FirstOrDefault(t => t.Name == student.Name) == null)
                {
                    _context.StudentInfos.Add(student);
                }
                _context.SaveChanges();
            }
        }
    }
}
```
然后在SeedHelper类中的SeedHostDb方法中，添加以下代码
`new DefaultTestDataForStudent(context).Create();`

在程序包管理器控制台，输入Update-Database，回车执行迁移。执行成功后，查看数据库，StudentInfo表创建成功，且表中已存在测试数据。






